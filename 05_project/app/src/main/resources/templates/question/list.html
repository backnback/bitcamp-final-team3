<!DOCTYPE html>
<html>
<head data-th-replace="~{header :: head}"></head>
<header data-th-replace="~{header :: #page-header}"></header>

<body>
<link data-th-href="@{/css/question.css}" rel="stylesheet">

<h1 class="text-center" style="margin-bottom: 50px;">일정 질문 게시판</h1>

<div class="search-sort-container">
    <!-- 검색창과 정렬/글쓰기 버튼을 감싸는 컨테이너 -->
    <div class="search-sort-wrapper">
        <!-- 검색창과 버튼 -->
        <form data-th-action="@{/question/list}" method="get" class="search-form">
            <input type="text" name="search" data-th-value="${search}" placeholder="일정 및 장소를 입력하세요" class="search-input">
            <button type="submit" class="btn btn-primary">검색</button>
        </form>

        <!-- 정렬 드롭다운과 글쓰기 버튼 -->
        <div class="sort-write-container">
            <select name="sort" id="sort" onchange="changeSort(this.value)" class="sort-select">
                <option value="latest" data-th-selected="${sort == 'latest' || sort == null}">최신순</option>
                <option value="likes" data-th-selected="${sort == 'likes'}">좋아요</option>
                <option value="favorites" data-th-selected="${sort == 'favorites'}">즐겨찾기</option>
                <option value="views" data-th-selected="${sort == 'views'}">조회수</option>
            </select>
            <a data-th-href="@{form}" class="btn btn-secondary">글쓰기</a>
        </div>
    </div>
</div>

<div class="card-list-container">
    <div class="card-list">
        <div data-th-each="board : ${list}">
            <a href="#" data-th-href="@{view(boardNo=${board.boardNo})}" class="card-container">

                <img data-th-src="${board.trip.city.cityPhoto != null ? board.trip.city.cityPhoto : '/images/default1.png'}" alt="City Photo" class="city-photo">
                <!-- 사용자 프로필 이미지 -->

                <div class="card-content">

                    <!-- 사용자 이름 -->
                    <div class="user-info" data-th-text="${board.writer.userNickname}">user1</div>

                    <!-- 게시물 미리보기 이미지 -->
                    <div class="image-container">
                        <img data-th-src="${board.writer.userPhoto != null ? board.writer.userPhoto : '/images/default.png'}" alt="User Photo" class="user-photo">

                    </div>

                    <!-- 게시물 제목 -->
                    <div class="title" data-th-text="${board.boardTitle}">제목</div>

                    <!-- 시간 및 위치 정보 -->
                    <div class="time-location">
                        <span data-th-text="${#calendars.format(board.boardCreatedDate, 'HH:mm')}">08:27</span> <br>
                        <span data-th-text="${board.trip.city.cityName}">대한민국 거제 통영</span>
                    </div>

                    <!-- 좋아요 및 댓글 아이콘 -->
                    <div class="icon-bar">
                        <div class="icon">
                            <img src="heart-icon.png" alt="Like Icon"> <span data-th-text="${board.boardLike}">0</span>
                        </div>
                        <div class="icon">
                            <img src="comment-icon.png" alt="Comment Icon"> <span data-th-text="${board.commentCount}">0</span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>

<!--<table>-->
<!--    <thead>-->
<!--    <tr><th>유저포토</th><th>유저닉네임</th><th>제목</th><th>장소</th><th>좋아요</th><th>즐겨찾기</th><th>댓글</th><th>조회수</th><th>작성일</th></tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--    <tr data-th-each="board : ${list}">-->
<!--&lt;!&ndash;        <td data-th-text="${board.writer.userPhoto}">포토</td>&ndash;&gt;-->
<!--        <td>-->
<!--        <img data-th-src="@{/images/default.png}"-->
<!--             data-th-unless="${board.writer.userPhoto}"-->
<!--             src="/images/default.png"-->
<!--             style="width: 40px; height: 35px;"> <br>-->
<!--        </td>-->
<!--        <td data-th-text="${board.writer.userNickname}">닉네임</td>-->
<!--        <td><a data-th-href="@{view(boardNo=${board.boardNo})}" data-th-text="*{board.boardTitle}">제목</a></td>-->
<!--        <td data-th-text="${board.trip.city.cityName}">장소</td>-->
<!--        <td data-th-text="${board.boardLike}">좋아요</td>-->
<!--        <td data-th-text="${board.boardFavor}">즐겨찾기</td>-->
<!--        <td data-th-text="${board.commentCount}">댓글</td>-->
<!--        <td data-th-text="${board.boardCount}">조회수</td>-->
<!--        <td data-th-text="${#calendars.format(board.boardCreatedDate, 'yyyy년 MM월 dd일')}">작성일</td>-->
<!--    </tr>-->
<!--    </tbody>-->
<!--</table>-->

<div>
    <span data-th-if="${pageNo > 1}">
        <a data-th-href="@{'list'(sort=${param.sort}, search=${search}, pageNo=${pageNo - 1}, pageSize=${pageSize})}">
            [이전]
        </a>
    </span>
    <span data-th-unless="${pageNo > 1}">[이전]</span>

    <span data-th-each="i : ${#numbers.sequence(1, pageCount)}">
        <a data-th-href="@{'list'(pageNo=${i}, sort=${param.sort}, search=${search})}" data-th-text="${i}">1</a>
    </span>

    <span data-th-if="${pageNo < pageCount}">
        <a data-th-href="@{'list'(sort=${param.sort}, search=${search}, pageNo=${pageNo + 1}, pageSize=${pageSize})}">
            [다음]
        </a>
    </span>
    <span data-th-unless="${pageNo < pageCount}">[다음]</span>
</div>

<h2>베스트 추천 게시글</h2>
<table>
    <thead>
    <tr><th>유저포토</th><th>유저닉네임</th><th>제목</th><th>장소</th><th>좋아요</th><th>즐겨찾기</th><th>댓글</th><th>조회수</th><th>날짜</th></tr>
    </thead>
    <tbody>
    <tr data-th-each="board : ${topBoards}">
        <td>
            <img data-th-src="@{/images/default.png}"
                 data-th-unless="${board.writer.userPhoto}"
                 src="/images/default.png"
                 style="width: 40px; height: 35px;"> <br>
        </td>
        <td data-th-text="${board.writer.userNickname}">닉네임</td>
        <td><a data-th-href="@{view(boardNo=${board.boardNo})}" data-th-text="*{board.boardTitle}">제목</a></td>
        <td data-th-text="${board.trip.city.cityName}">장소</td>
        <td data-th-text="${board.boardLike}">좋아요</td>
        <td data-th-text="${board.boardFavor}">즐겨찾기</td>
        <td data-th-text="${board.commentCount}">댓글</td>
        <td data-th-text="${board.boardCount}">조회수</td>
        <td data-th-text="${#calendars.format(board.boardCreatedDate, 'yyyy년 MM월 dd일')}">날짜</td>
    </tr>
    </tbody>
</table>


<script>
    function changeSort(sortType) {
        window.location.href = 'list?sort=' + sortType + '&search=' + encodeURIComponent(document.querySelector('input[name="search"]').value);
    }
</script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
