<!DOCTYPE html>
<html>

<head data-th-replace="~{header :: head}"></head>
<header data-th-replace="~{header :: #page-header}"></header>
<link data-th-href="@{/css/review.css}" rel="stylesheet">

<body>
<div class="container my-5">
    <h1 class="text-center my-4">여행 후기 게시판</h1>

    <!-- 검색옵션 -->
    <div class="d-flex justify-content-center align-items-center gap-3 my-3" style="margin-left: 100px;">


        <!-- 검색 폼 -->
        <form data-th-action="@{/review/search}" method="get" class="input-group" style="width: 600px;">
            <!-- 검색옵션 -->
            <div class="d-flex align-items-center gap-2"  style="width: auto;">
                <select id="search-option" name="option" class="form-select" style="width: auto; margin-right: 5px;">
                    <option value="title">제목</option>
                    <option value="writer">작성자</option>
                    <option value="city">장소[시도]</option>
                    <option value="tag">태그</option>
                </select>
            </div>

            <input type="text" name="query" data-th-value="${query}" placeholder="일정 및 장소를 입력하세요" class="form-control">
            <button type="submit" class="btn btn-outline-secondary">
                <i class="bi bi-search"></i> <!-- 돋보기 -->
            </button>
        </form>

        <!-- 정렬 드롭다운과 글쓰기 버튼 -->
        <div class="d-flex align-items-center gap-2">
            <select name="sort" id="sort" onchange="changeSort(this.value)" class="form-select" style="width: auto;">
                <option value="latest" data-th-selected="${sort == 'latest' || sort == null}">최신순</option>
                <option value="likes" data-th-selected="${sort == 'likes'}">좋아요</option>
                <option value="favorites" data-th-selected="${sort == 'favorites'}">즐겨찾기</option>
                <option value="views" data-th-selected="${sort == 'views'}">조회수</option>
            </select>
            <a data-th-href="@{form}" class="btn btn-secondary">글쓰기</a>
        </div>
    </div>
</div>

<div class="card-list-container">
    <div class="card-list">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 justify-content-start">
            <!-- 실제 카드 항목 -->
            <div class="col" data-th-each="board : ${list}">
                <div class="card h-100">
                    <div class="card-img-wrapper position-relative">
                        <img src="https://via.placeholder.com/400x150"
                             class="card-img-top position-absolute top-0 start-0 w-100 h-100"
                             style="object-fit: cover;"
                             alt="게시글 이미지">
                    </div>
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-title">
                            <a data-th-href="@{view(boardNo=${board.boardNo})}"
                               data-th-text="${board.boardTitle}"
                               class="text-decoration-none text-truncate d-block"></a>
                        </h6>
                        <div class="card-text small">
                            <p class="mb-1">작성자: <span data-th-text="${board.writer.userNickname}"></span></p>
                            <p class="mb-1">작성일: <span data-th-text="${#dates.format(board.boardCreatedDate, 'yyyy-MM-dd')}"></span></p>
                            <p class="mb-1">태그: <span data-th-text="${board.boardTag}"></span></p>
                            <p class="mb-1">위치: <span data-th-text="${board.trip.city.cityName}"></span></p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between align-items-center small text-muted">
                            <span>❤️ <span data-th-text="${board.boardLike}"></span></span>
                            <span>⭐ <span data-th-text="${board.boardFavor}"></span></span>
                            <span>👀 <span data-th-text="${board.boardCount}"></span></span>
                            <span>💬 <span data-th-text="${board.commentCount}"></span></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 빈 카드 플레이스홀더 (필요한 경우에만 표시) -->
            <div class="col d-none d-md-block" data-th-if="${list.size() % 2 == 1}"></div>
            <div class="col d-none d-lg-block" data-th-if="${list.size() % 4 == 1 || list.size() % 4 == 2 || list.size() % 4 == 3}"></div>
            <div class="col d-none d-lg-block" data-th-if="${list.size() % 4 == 1 || list.size() % 4 == 2}"></div>
            <div class="col d-none d-lg-block" data-th-if="${list.size() % 4 == 1}"></div>
        </div>
    </div>
</div>

<!-- 페이지 네비게이션 -->
<div class="container mt-4">
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item" data-th-classappend="${pageNo <= 1 ? 'disabled' : ''}">
                <a class="page-link" data-th-href="@{'list'(sort=${sort}, option=${option}, query=${query}, pageNo=${pageNo - 1}, pageSize=${pageSize})}"
                   aria-label="Previous">
                    <span aria-hidden="true">[이전]</span>
                </a>
            </li>
            <li class="page-item" data-th-each="i : ${#numbers.sequence(1, pageCount)}"
                data-th-classappend="${pageNo == i ? 'active' : ''}">
                <a class="page-link" data-th-href="@{'list'(sort=${sort}, option=${option}, query=${query}, pageNo=${i})}" data-th-text="${i}"></a>
            </li>
            <li class="page-item" data-th-classappend="${pageNo >= pageCount ? 'disabled' : ''}">
                <a class="page-link" data-th-href="@{'list'(sort=${sort}, option=${option}, query=${query}, pageNo=${pageNo + 1}, pageSize=${pageSize})}"
                   aria-label="Next">
                    <span aria-hidden="true">[다음]</span>
                </a>
            </li>
        </ul>
    </nav>
</div>


<script>
    <!--정렬변경-->
    function changeSort(sortType) {
        window.location.href = 'list?sort=' + sortType;
    }
</script>

<!-- Bootstrap CSS 및 JS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<!-- fontawesome -->
<script src="https://kit.fontawesome.com/ecaa6a7d50.js" crossorigin="anonymous"></script>

</body>
</html>
